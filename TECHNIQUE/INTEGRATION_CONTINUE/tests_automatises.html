
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://uepal-civiparoisse-documentation.github.io/index.html/TECHNIQUE/INTEGRATION_CONTINUE/tests_automatises.html">
      
      
        <link rel="prev" href="docker_build_push.html">
      
      
        <link rel="next" href="tests_phpunit.html">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.13">
    
    
      
        <title>Tests automatisés : Codeception - Documentation UEPAL Civiparoisse</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tests-dacceptation-automatises-codeception" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../../index.html" title="Documentation UEPAL Civiparoisse" class="md-header__button md-logo" aria-label="Documentation UEPAL Civiparoisse" data-md-component="logo">
      
  <img src="../../assets/uepal-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentation UEPAL Civiparoisse
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tests automatisés : Codeception
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Partager" aria-label="Partager" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Onglets" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
  
    
  
  Documentation Civiparoisse

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../UTILISATION/mode_emploi/index.html" class="md-tabs__link">
          
  
  
    
  
  Mode d'emploi

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../PRESENTATION/index.html" class="md-tabs__link">
          
  
  
    
  
  Présentation du projet

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../index.html" class="md-tabs__link">
          
  
  
    
  
  Eléments techniques

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../FORMATION/index.html" class="md-tabs__link">
          
  
  
    
  
  Formation

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Documentation UEPAL Civiparoisse" class="md-nav__button md-logo" aria-label="Documentation UEPAL Civiparoisse" data-md-component="logo">
      
  <img src="../../assets/uepal-logo.svg" alt="logo">

    </a>
    Documentation UEPAL Civiparoisse
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation Civiparoisse
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../UTILISATION/mode_emploi/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Mode d'emploi
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Mode d'emploi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/debuter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Débuter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/fiches_contact.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gérer les fiches
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/relations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gérer les relations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/liens_paroisses.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gérer les liens avec la paroisse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/faire_des_recherches_sur_les_contacts.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Faire des recherches sur les contacts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/envoyer_un_courriel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Envoyer un courriel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/groupes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gérer les groupes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/listes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utiliser les listes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/que_faire_quand.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Que faire quand... ?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/gestion_des_dons_et_edition_des_recus_fiscaux.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gestion des dons et édition des reçus fiscaux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/creer_et_gerer_un_evenement.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Créer et gérer un événement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/operations_a_mener_regulierement.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Opérations à mener régulièrement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/gestion_base_donnees.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Administration locale de la base de données
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/prepaper_installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Préparer l'installation initiale de CiviParoisse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/nouveautes_CiviParoisse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Les nouveautés dans CiviParoisse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UTILISATION/mode_emploi/ressources.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ressources utiles
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../PRESENTATION/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Présentation du projet
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Présentation du projet
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PRESENTATION/presentation_fonctionnelle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Périmètre fonctionnel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PRESENTATION/presentation_ecosysteme.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ecosystème projet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PRESENTATION/presentation_livrables.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Livrables
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Eléments techniques
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Eléments techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../EXPLOITATION/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Exploitation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Exploitation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../EXPLOITATION/logs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../POC/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    POC
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3" id="__nav_4_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            POC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../POC/remontage_local.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Remontage en local
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../PREPOC/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    PRE_POC
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4" id="__nav_4_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            PRE_POC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/prepoc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Description générale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../PREPOC/ETUDES_PRECIS/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Etudes - précis techniques
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4_3" id="__nav_4_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_3">
            <span class="md-nav__icon md-icon"></span>
            Etudes - précis techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/ETUDES_PRECIS/infrastructure.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Infrastructure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/ETUDES_PRECIS/trafic_entrant.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trafic initiateur entrant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/ETUDES_PRECIS/traefik.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maquettage Traefik
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/ETUDES_PRECIS/identites_certificats.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Identités et certificats
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/ETUDES_PRECIS/waf.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Application Firewall
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/ETUDES_PRECIS/integration_ca.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intégration CA Ubuntu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/ETUDES_PRECIS/minikube_traefik_wildcard.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minikube + Traefik + Wildcard
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../PREPOC/INTEGRATION/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Opérationnel
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4_4" id="__nav_4_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_4">
            <span class="md-nav__icon md-icon"></span>
            Opérationnel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/deploiement_instance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Déploiement instance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/docker.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Description générale Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../PREPOC/INTEGRATION/DOCKER/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Images Docker
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4_4_4" id="__nav_4_4_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_4_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_4_4">
            <span class="md-nav__icon md-icon"></span>
            Images Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/selfkeys.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    selfkeys
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/keys_init.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    keys_init
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/mysql_tls_router.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mysql_tls_router
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/mysql_tls_server.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mysql_tls_server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/composer_base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    composer_base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/composer_files.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    composer_files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/tools.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/tools_debug" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tools_debug
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/init.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    init
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/cron.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cron
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/httpd.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    httpd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/httpd_debug.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    httpd_debug
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/update.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    update
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/test_msmtp_dovecot.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    test_msmtp_dovecot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/gen_hashed_ca.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gen_hashed_ca
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/DOCKER/traefik_docker.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    traefik_docker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_4_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../PREPOC/INTEGRATION/KUBERNETES/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4_4_5" id="__nav_4_4_4_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_4_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_4_5">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/maquettage.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maquettage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/ressources.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ressources utiles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_4_5_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../PREPOC/INTEGRATION/KUBERNETES/HELM/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Chart Helm
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4_4_5_4" id="__nav_4_4_4_5_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_4_4_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_4_5_4">
            <span class="md-nav__icon md-icon"></span>
            Chart Helm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/HELM/description_generale.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Description générale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/HELM/db_dbrouter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DB et DB Router
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/HELM/httpd.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serveur web interne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/HELM/cron.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cron
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/HELM/volumes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Volumes (persistants)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/HELM/secrets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Secrets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/HELM/reservations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Réservations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/HELM/maildemo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serveur mail de démo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PREPOC/INTEGRATION/KUBERNETES/HELM/tools.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../roles.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rôles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../MAIL/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Mail
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_6" id="__nav_4_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Mail
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MAIL/mail.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Problématique
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MAIL/ecosysteme.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ecosystème
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MAIL/sendmail.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Envoi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MAIL/fetchmail.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Réception
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MAIL/opensmtpd_dovecot.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Opensmtpd Dovecot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../LOGICIEL/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Logiciel
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_7" id="__nav_4_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Logiciel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LOGICIEL/distribution_code_composer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distribution de code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LOGICIEL/environnement_dev.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environnement de dev
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LOGICIEL/environnement_dev_env.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Personnalisation environnement de dev
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LOGICIEL/importation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Importation de données
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Intégration Continue
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_8" id="__nav_4_8_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Intégration Continue
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="docker_build_push.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker build et push
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Tests automatisés : Codeception
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="tests_automatises.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Tests automatisés : Codeception
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-a-codeception" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction à Codeception
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#principe-des-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Principe des tests
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-initiale" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration initiale
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-projet" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration projet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecriture-des-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Ecriture des tests
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retour-dexperience-sur-lecriture-des-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Retour d'expérience sur l'écriture des tests
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objectifs-des-tests-automatises-dans-le-cadre-de-civiparoisse" class="md-nav__link">
    <span class="md-ellipsis">
      Objectifs des tests automatisés dans le cadre de Civiparoisse
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reflexions-resultant-des-objectifs" class="md-nav__link">
    <span class="md-ellipsis">
      Réflexions résultant des objectifs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resume-de-la-solution-retenue" class="md-nav__link">
    <span class="md-ellipsis">
      Résumé de la solution retenue
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tests_phpunit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tests automatisés : Phpunit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="composer_ci.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Composer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="trivy_ci.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trivy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sonarqube_ci.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SonarLint et SonarQube
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../ARCHIVES/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    ARCHIVES
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            ARCHIVES
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../FORMATION/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Formation
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Formation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="tests-dacceptation-automatises-codeception"><a class="toclink" href="#tests-dacceptation-automatises-codeception">Tests d'acceptation automatisés : Codeception</a></h1>
<p>Les tests logiciels automatisés sont un domaine important du génie logiciel. Les tests permettent de vérifier que des modifications de code ou d'environnement n'entraînent pas des régressions, et facilitent donc la maintenance opérationnelle des logiciels.</p>
<p>Au niveau de Civiparoisse, on constate qu'il n'y a que peu de code spécifique, et que ce code spécifique est plutôt destiné à du paramétrage qu'à de l'implémentation de fonctionnalités. De ce fait, les tests les plus utiles sont les tests d'acceptation automatisés, qui vont vérifier de bout en bout le bon fonctionnement du logiciel. De plus, ces tests de bout en bout peuvent contribuer à la documentation du projet, puisqu'ils implémentent des scénarios reproduisant des utilisations réelles.</p>
<h2 id="introduction-a-codeception"><a class="toclink" href="#introduction-a-codeception">Introduction à Codeception</a></h2>
<p>L'outil utilisé pour réaliser ces tests est <a href="https://codeception.com/">Codeception</a>. Codeception est écrit en PHP, et propose une manière d'écrire des tests de manière très intuitive au niveau des tests d'acceptation, en utilisant des classes "Acteurs" regroupant toutes les actions disponibles. Il est installable via Composer et propose une architecture modulaire, en fonction des besoins des projets.</p>
<p>Parallèlement aux modules, on retrouve également un autre type d'éléments de code qui a été personalisé : il s'agit des extensions de Codeception. Les extensions ont plutôt un rôle support par rapport aux modules : ils peuvent par exemple personnaliser la manière dont les logs sont effectués, ils peuvent enregistrer des screenshots... Une extension dérivant de l'extension Recorder a d'ailleurs été préparée de sorte à pouvoir commenter des étapes de test, de sorte à améliorer l'aspect "documentation utilisateur" des tests.</p>
<h2 id="principe-des-tests"><a class="toclink" href="#principe-des-tests">Principe des tests</a></h2>
<p>Le principe des tests qui vont être réalisés va être le suivant :</p>
<ul>
<li>
<p>Codeception va dialoguer via le protocole WebDriver avec un Driver de Navigateur (chromedriver pour chrome ou chromium, geckodriver pour firefox, pour ce citer qu'eux) ; ce dialogue est un dialogue HTTP en clair, qu'il peut être utile à l'occasion de capturer via des outils réseaux tels que tcpdump ou wireshark, car ils peuvent fournir par moment des indications précieuses sur des cas d'erreurs.</p>
</li>
<li>
<p>Le driver va lancer le navigateur et s'interfacer avec lui.</p>
</li>
<li>
<p>Le navigateur va tenter d'effectuer les actions qu'on lui demande : naviguer sur le site et effectuer des interactions spécifiques.</p>
</li>
</ul>
<h2 id="configuration-initiale"><a class="toclink" href="#configuration-initiale">Configuration initiale</a></h2>
<p>Codeception utilise un fichier de configuration principal, au format yaml : codeception.yml. La mise en place de la configuration de Codeception a débutée par la création du modèle via <code>codecept init acceptance</code>. Il devient ensuite simple de faire évoluer la configuration grâce à la documentation.</p>
<p>La configuration initiale est :</p>
<details class="info">
<summary>Codeception.yaml initial (cliquer pour déplier)</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># suite config</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nt">suites</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="nt">acceptance</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">        </span><span class="nt">actor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AcceptanceTester</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">        </span><span class="nt">modules</span><span class="p">:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">WebDriver</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">                    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://localhost</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">                    </span><span class="nt">browser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">chrome</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">\Helper\Acceptance</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">        </span><span class="c1"># add Codeception\Step\Retry trait to AcceptanceTester to enable retries</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">        </span><span class="nt">step_decorators</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Codeception\Step\ConditionalAssertion</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Codeception\Step\TryTo</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Codeception\Step\Retry</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="nt">extensions</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Codeception\Extension\RunFailed</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="nt">params</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">env</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="nt">gherkin</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w">    </span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="c1"># additional paths</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="nt">paths</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="w">    </span><span class="nt">tests</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="w">    </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/_output</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="w">    </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/_data</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="w">    </span><span class="nt">support</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/_support</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="w">    </span><span class="nt">envs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/_envs</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="nt">settings</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="w">    </span><span class="nt">lint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</details>
<p>Au niveau des fichiers générés, on retrouve :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>./tests/LoginCest.php
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>./tests/_data/.gitkeep
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>./tests/_output/.gitkeep
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>./tests/_support/Helper/Acceptance.php
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>./tests/_support/AcceptanceTester.php
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>./tests/_support/_generated/AcceptanceTesterActions.php
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>./codeception.yml
</code></pre></div>
<p>Le fichier LoginCest.php est un exemple de fichier de test généré initialement :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="cp">&lt;?php</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">class</span> <span class="nc">LoginCest</span> 
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="p">{</span>    
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="k">public</span> <span class="k">function</span> <span class="nf">_before</span><span class="p">(</span><span class="nx">AcceptanceTester</span> <span class="nv">$I</span><span class="p">)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="p">{</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>        <span class="nv">$I</span><span class="o">-&gt;</span><span class="na">amOnPage</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="p">}</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>    <span class="k">public</span> <span class="k">function</span> <span class="nf">loginSuccessfully</span><span class="p">(</span><span class="nx">AcceptanceTester</span> <span class="nv">$I</span><span class="p">)</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    <span class="p">{</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>        <span class="c1">// write a positive login test </span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>    <span class="p">}</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>    <span class="k">public</span> <span class="k">function</span> <span class="nf">loginWithInvalidPassword</span><span class="p">(</span><span class="nx">AcceptanceTester</span> <span class="nv">$I</span><span class="p">)</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>    <span class="p">{</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>        <span class="c1">// write a negative login test</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    <span class="p">}</span>       
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="p">}</span>
</code></pre></div>
<p>La classe AcceptanceTester.php est générée et intègre le trait AcceptanceTesterActions, qui est généré pour ajouter les méthodes publiques intégrés dans le module Acceptance (fichier <code>tests/_support/Helper/Acceptance.php</code>).</p>
<p>Il est possible de reconstruire l'AcceptanceTester de manière manuelle (<code>codecept build</code>) ; l'AcceptanceTester est de toute manière reconstruit avant l'exécution des tests : c'est grâce à ce mécanisme que l'AcceptanceTester tient également compte des actions situées dans les modules actifs de Codeception.</p>
<p>Le module Acceptance permet d'implémenter des routines qui peuvent être utilisées un peu partout dans les tests, comme par exemple, le login, le logout, ou dans le cas plus spécifique de CiviCRM, l'accès à une fiche contact via son nom trié (<code>sort_name</code>).</p>
<h2 id="configuration-projet"><a class="toclink" href="#configuration-projet">Configuration projet</a></h2>
<p>La configuration utilisée pour les tests automatisés est présentée en-dessous :</p>
<details class="info">
<summary>Codeception.yml projet  (cliquer pour déplier)</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># suite config</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nt">suites</span><span class="p">:</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="nt">acceptance</span><span class="p">:</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">        </span><span class="nt">actor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AcceptanceTester</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">        </span><span class="nt">extensions</span><span class="p">:</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Uepal\Documentor\Documentor</span><span class="p">:</span><span class="w">                 </span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">                    </span><span class="nt">delete_successful</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">                    </span><span class="nt">delete_orphaned</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Codeception\Extension\Logger</span><span class="p">:</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">                    </span><span class="nt">max_files</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">        </span><span class="nt">modules</span><span class="p">:</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Db</span><span class="p">:</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">                    </span><span class="nt">dsn</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mysql:host=127.0.0.1;dbname=%cividbdatabase%&#39;</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">                    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;%cividbusername%&#39;</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w">                    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;%cividbpassword%&#39;</span><span class="w">         </span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">                    </span><span class="nt">initial_queries </span><span class="p">:</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="w">                      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;SET</span><span class="nv"> </span><span class="s">time_zone=&#39;%tz%&#39;&quot;</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Asserts</span><span class="p">:</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">WebDriver</span><span class="p">:</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="w">                    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;%weburl%&#39;</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="w">                    </span><span class="nt">browser</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;chrome&#39;</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="w">                    </span><span class="nt">window_size</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1920x1080&#39;</span><span class="w">                    </span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="w">                    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="w">                    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9515</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="w">                    </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;127.0.0.1&#39;</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="w">                    </span><span class="nt">capabilities</span><span class="p">:</span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="w">                        </span><span class="nt">unhandledPromptBehavior</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;accept&quot;</span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="w">                        </span><span class="nt">acceptInsecureCerts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="w">                        </span><span class="nt">chromeOptions</span><span class="p">:</span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="w">                            </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;--headless&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;--disable-gpu&quot;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="w">                            </span><span class="nt">prefs</span><span class="p">:</span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="w">                              </span><span class="nt">download.default_directory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./tests/_output&quot;</span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="w">                    </span><span class="nt">wait</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">\Helper\Acceptance</span><span class="p">:</span>
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="w">                    </span><span class="nt">adminusername</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;%adminusername%&#39;</span>
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="w">                    </span><span class="nt">adminpassword</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;%adminpassword%&#39;</span>
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a><span class="w">                    </span><span class="nt">gestionnaireusername</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;%gestionnaireusername%&#39;</span>
<a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="w">                    </span><span class="nt">gestionnairepassword</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;%gestionnairepassword%&#39;</span>
<a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="w">                    </span><span class="nt">utilisateurparoissialusername</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;%utilisateurparoissialusername%&#39;</span>
<a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="w">                    </span><span class="nt">utilisateurparoissialpassword</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;%utilisateurparoissialpassword%&#39;</span>
<a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="w">                    </span><span class="nt">sleeptime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a>
<a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a>
<a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a><span class="w">        </span><span class="c1"># add Codeception\Step\Retry trait to AcceptanceTester to enable retries</span>
<a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a><span class="w">        </span><span class="nt">step_decorators</span><span class="p">:</span>
<a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Codeception\Step\ConditionalAssertion</span>
<a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Codeception\Step\TryTo</span>
<a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Codeception\Step\Retry</span>
<a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a>
<a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a><span class="nt">extensions</span><span class="p">:</span>
<a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Codeception\Extension\RunFailed</span><span class="p p-Indicator">]</span>
<a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a>
<a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a><span class="nt">params</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">env</span>
<a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">codecept_config/params.yml</span>
<a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">codecept_config/db_params.yml</span>
<a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">codecept_config/tz.yml</span>
<a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a><span class="nt">gherkin</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w">    </span>
<a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a>
<a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a><span class="c1"># additional paths</span>
<a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a><span class="nt">paths</span><span class="p">:</span>
<a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a><span class="w">    </span><span class="nt">tests</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests</span>
<a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a><span class="w">    </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/_output</span>
<a id="__codelineno-3-67" name="__codelineno-3-67" href="#__codelineno-3-67"></a><span class="w">    </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/_data</span>
<a id="__codelineno-3-68" name="__codelineno-3-68" href="#__codelineno-3-68"></a><span class="w">    </span><span class="nt">support</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/_support</span>
<a id="__codelineno-3-69" name="__codelineno-3-69" href="#__codelineno-3-69"></a><span class="w">    </span><span class="nt">envs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/_envs</span>
<a id="__codelineno-3-70" name="__codelineno-3-70" href="#__codelineno-3-70"></a>
<a id="__codelineno-3-71" name="__codelineno-3-71" href="#__codelineno-3-71"></a><span class="nt">settings</span><span class="p">:</span>
<a id="__codelineno-3-72" name="__codelineno-3-72" href="#__codelineno-3-72"></a><span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id="__codelineno-3-73" name="__codelineno-3-73" href="#__codelineno-3-73"></a><span class="w">    </span><span class="nt">lint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</details>
<p>Il mérite quelques commentaires :</p>
<ul>
<li>Les modules utilisés sont le module WebDriver (communication avec le navigateur), le module Db (communication avec mysql) et Assert (pour des tests de logiques, comme du AssertTrue).</li>
<li>L'extension Documentor est une extension préparée pour le projet, qui hérite de l'extension Codeception\Extension\Recorder et permet l'utilisation des actions de commentaire (comme <code>amGoingTo</code>) pour ajouter des commentaires dans les slides générées.</li>
<li>L'extension Codeception\Extension\Logger permet de générer un fichier de log avec des entrées datées, ce qui est très utile pour vérifier comment se sont déroulés les tests, et combien de temps ont pris chaque test ; l'extension s'intègre correctement dans les fichiers de Codeception grâce à l'utilisation de Composer.</li>
<li>Les paramètres de configuration des modules et des extensions sont situés dans la hiérarchie mentionnant leur nom.</li>
<li>La configuration de la base de données a nécessité de rajouter l'indication du fuseau horaire : cette indication permet surtout de s'adapter à un poste utilisateur (par exemple sur le fuseau Europe/Paris) et un système configuré en UTC, lorsqu'on utilise des vérifications horaires (par exemple quand on cherche un mail dans la base de données).</li>
<li>le navigateur utilisé est chromium ou chrome. Il est utilisé en mode headless, c'est à dire que l'on n'utilise pas d'affichage à proprement parler, comme on pourrait le faire via Xvfb, et éventuellement un gestionnaire de fenêtres. Du coup, il convient d'indiquer la résolution souhaitée. Cette résolution sera non pas la résolution de la fenêtre d'affichage, mais la résolution du viewport. Les tailles d'affichages peuvent par exemple jouer sur les résultats de certains tests en particulier en cas de superpositions d'éléments graphiques. Le fait d'utiliser le mode headless permet de fixer un comportement, et d'éviter des différences de comportement dans le temps.</li>
<li>Des capacités particulières ont été demandées au navigateur : certaines sont explicites, comme le mode headless (et la désactivation de l'utilisation du gpu), ou la personnalisation du répertoire de destination des fichiers téléchargé, ou l'acceptation de certificats non reconnus comme sûrs (très utile pour les certificats autosignés). En revanche, la capacité unhandledPromptBehavior voir (<a href="https://www.w3.org/TR/webdriver1/#dfn-user-prompt-handler">https://www.w3.org/TR/webdriver1/#dfn-user-prompt-handler</a>) est nécessaire car les navigateurs récents émettent de temps à autre des demandes de confirmation, tel que le réenvoi d'un formulaire ou la sortie d'une page où on a renseigné des informations.</li>
<li>Etant donné que la plupart des scénarios de tests nécessitent qu'un utilisateur soit loggué, il faut également prévoir les informations de login dans la configuration.</li>
<li>Le fichier permet l'utilisation de variables notés entre des symboles pourcents, et les variables sont remplacées par les éléments indiqués dans la section params (ici, on consultera d'abord, l'environnement de l'exécution de Codeception, puis les fichiers mentionnés). Le remplacement est effectué assez tôt dans le traitement de la configuration, ce qui fait qu'il est possible de mettre des paramètres dans un grand nombre d'endroits.</li>
</ul>
<h2 id="ecriture-des-tests"><a class="toclink" href="#ecriture-des-tests">Ecriture des tests</a></h2>
<p>L'écriture des tests suit une logique assez simple :</p>
<ul>
<li>On commence tout d'abord par définir un scénario utilisateur complet que l'on veut intégrer dans un test.</li>
<li>On identifie les dépendances sur des données que le test va avoir : ces dépendances de données peuvent être soit intégrées dans la base de données, lors de la préparation initiale pour les tests (établissement d'une Golden Database), soit intégrées à la volée, à l'occasion de l'exécution du scénario (comme la mise en place de fixtures lors d'un test unitaire).</li>
<li>En écrivant le test, on va le dérouler en même temps manuellement dans un navigateur : l'utilisation des outils de développements permettra d'identifier des sélecteurs pour désigner les éléments avec lesquels interagir. Les sélecteurs sont généralement des sélecteurs css, des sélecteurs xpath, ou des noms d'éléments de formulaires.</li>
<li>On va chercher à exécuter un test uniquement via l'utilisation des groupes de tests : on peut par exemple rajouter une annotation de groupe de type <code>@group nom_de_groupe</code> dans le docblock situé au-dessus d'une fonction de test. De la sorte, on pourra préciser à Codeception le nom du groupe de tests à exécuter, et on pourra ainsi débugger le test que l'on est en train d'écrire.</li>
</ul>
<h2 id="retour-dexperience-sur-lecriture-des-tests"><a class="toclink" href="#retour-dexperience-sur-lecriture-des-tests">Retour d'expérience sur l'écriture des tests</a></h2>
<p>En pratique, il y a quelques difficultés qui apparaissent :</p>
<ul>
<li>Le <strong>scénario utilisateur</strong> doit être suffisamment clair, précis et explicite (détaillé) pour pouvoir permettre son implémentation.</li>
<li>Il est rare de réussir à écrire un test correctement du premier coup : <strong>plusieurs exécutions successives du scénario</strong> sont souvent nécessaires jusqu'à arriver à un scénario entièrement fonctionnel. Toutefois, il est ennuyeux et peu efficace de devoir resetter l'environnement de données à chaque exécution lors de l'écriture du code. Ainsi, on cherchera à écrire des tests répétables : les données qui sont normalement laissées "non altérés" à l'issue des tests, ou qui sont uniquement utilisées en lecture par des données de tests, peuvent être intégrées dans une approche GoldenDatabase. Les autres données, en revanche, chercheront à être uniques. Le nom d'un individu crée lors d'un test pourra par exemple être constitué d'un préfixe identifiant le test et la personne dans le test, et d'un suffixe qui est un estampillage horaire. Ceci en fait une valeur unique par exécution, et simplifie également l'accès aux éléments grâce au ciblage précis permis par les valeurs uniques - sans compter que les estimpillages horaires sont croissants. Cela facilite donc les vérifications d'un développeur lors de vérification sucessives au cours de l'écriture du test.</li>
<li>La difficulté principale est d'<strong>écrire de bons sélecteurs</strong>. La plupart des sélecteurs sont généralement simples à écrire, en utilisant un id ou une classe CSS. Les difficultés commencent lorsqu'on doit travailler sur des éléments avec des interfaces complexes, dont certains éléments sont générés à la volée (explorateur API, searchKit pour ne citer qu'eux).<ul>
<li>Un autre type de difficulté arrive lorsqu'on cherche à vérifier plusieurs conditions simultanément : dans ce genre de cas, le XPath est généralement assez souple et permet d'exprimer les conditions par rapport aux noeuds du document, au prix parfois d'une certaine lourdeur d'écriture. Il y a parfois même lieu de faire des vérifications d'une manière différente, lorsqu'on cherche à vérifier qu'il n'y a pas un élément : on peut faire exécuter du code javascript pour récupérer un nombre d'éléments correspondant à une condition, et vérifier que ce nombre vaut zéro.</li>
</ul>
</li>
<li>Lorsqu'on a écrit un sélecteur, on va vouloir le tester, ou, si l'on se trouve face à du code difficilement compréhensible, on va pouvoir chercher à retrouver les éléments visés par un sélecteur. A ce moment, <strong>la console javascript du navigateur</strong> est particulièrement utile : on peut utiliser `jQuery('mon sélecteur CSS'), $x('mon sélecteur xpath'), et si ce dernier ne marche pas, utiliser document.evaluate (voir par exemple <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/evaluate">https://developer.mozilla.org/en-US/docs/Web/API/Document/evaluate</a>). De la sorte, il arrive fréquemment que si l'on survole ou clique sur un élément de résultat, il apparaît en surbrillance dans le rendu HTML à l'écran. Cette technique pourrait d'ailleurs même participer à l'utilisation des tests comme documentation.</li>
<li><strong>Les widgets spécifiques</strong> : si Codeception est particulièrement bien pourvu pour travailler avec des éléments HTML classiques, il y a cependant lieu de noter que des schémas types d'interaction avec certains éléments, comme les sélecteurs de date ou les autocomplétions, reviennent assez régulièrement. Lorsqu'on rencontre un widget, il est donc intéressant de chercher dans le code existant s'il n'a pas déjà été rencontré, afin de se simplifier le travail d'interaction. Il pourrait éventuellement être envisagé de créer des fonctions génériques pour manipuler les widgets. Mais il semblerait toutefois que des variantes existent, et dont il faudrait également tenir compte : il n'est donc pas évident qu'une telle librairie serait vraiment opportune.</li>
<li><strong>Les commentaires</strong> : il ne faut pas hésiter à commenter quasiment chaque ligne d'action, pour indiquer clairement l'intention liée à l'action. En effet, si une action ou une vérification ne s'effectue plus correctement, il n'est pas évident qu'un sélecteur soit suffisamment explicite pour comprendre l'intention du développeur liée à l'action. Le fait de commenter le code permet donc non seulement d'aiguiller l'utilisateur, mais également le développeur lorsqu'il devra remanier un test qui ne fonctionne plus.</li>
<li>Les tests réalisés peuvent être longs et complexes à écrire. Il peut très bien s'avérer être nécessaire de mettre en oeuvre des <strong>éléments de génie logiciel</strong> (fonctions protégées par exemple, pour du code qui est réutilisé plusieurs fois au sein d'une classe de test, ou mise à disposition de code via le module helper Acceptance). On en déduit donc que l'écriture de tests constitue de l'écriture de code logiciel qui doit chercher à respecter les bonnes pratiques et usages des technologies mises en oeuvres.</li>
<li>Il a <strong>des temporisations</strong> qui sont liées au temps de traitement des requêtes, d'où la mise en place de temps d'attente (la fonction sleepForDisplay qui utilise la fonction wait). A l'inverse, il faut également configurer CiviCRM pour ne pas supprimer automatiquement les notifications de l'écran après un certain délai : ces suppressions cumulées aux temps d'attentes risqueraient de mettre en échec un bon nombre d'assertions qui visent les messages de notification.</li>
<li>Une autre difficulté est <strong>l'écriture dans certains éléments</strong>. Il arrive que l'on doive cibler des éléments qui sont marqués comme éditables et qui ne sont pas des éléments de formulaire. A ce moment, on utilise des fonctions comme <code>type</code>. On peut également être tenté d'utiliser du javascript pour positionner un contenu. Néanmoins, le fait de passer par le javascript peut ne pas déclencher un certain nombre d'évènements qui se déclencheraient en utilisation "traditionnelle" par un utilisateur humain de la page. Ce genre d'approche doit donc être évitée dans la mesure du possible.</li>
<li>Il y a également parfois des <strong>interactions avec des tâches CRON</strong>. La solution la plus simple trouvée pour le moment est de se loguer en administrateur dans CiviCRM, et déclencher un appel aux tâches CRON via l'API JS. En attendant un temps suffisant, on peut ensuite chercher à vérifier si la tâche a été exécutée.</li>
<li><strong>Eléments situés dans un iframe</strong> : il faut indiquer quand il faut considérer un iframe à codeception, et revenir ensuite à la frame principale.</li>
<li><strong>Eléments ouverts dans un autre onglet</strong> : il faut penser à utiliser les fonctions associées (switch to next tab, close tab).</li>
<li><strong>Vérification du résultat d'un code exécuté en JS</strong> : la méthode la plus simple de vérifier le retour a été d'écrire directement du contenu dans la page HTML, des essais avec des notifications JS du type window.alert n'ayant pas donné les résultats escomptés lors de l'écriture du code.</li>
<li><strong>Vérification des mails</strong> : CiviCRM propose de stocker les mails qui devraient être envoyés en temps normal dans une table. Cette manière de faire permet d'éviter de déployer un environnement plus conséquent, et plus difficile à exploiter depuis Codeception. On peut effectuer des vérifications sur la base de données depuis Codeception. En se notant avant l'exécution d'un test l'estampillage horaire, il devient possible de déduire quels sont les mails stockés qui ont été générés lors du test courant (en tenant compte comme décrit plus haut du fuseau horaire), et d'effectuer des vérifications dans les destinataires, les sujets, et les contenus.</li>
<li><strong>Survol d'éléments</strong> : il y a eu des difficultés pour le survol des éléments de menu avec les fonctions comme moveMouseOver. Le contournement a été de cliquer sur un élément de menu, mais sans cliquer sur le lien éventuellement associé, donc ne pas mettre une indication de lien <code>a</code> dans les sélecteurs.</li>
</ul>
<h2 id="objectifs-des-tests-automatises-dans-le-cadre-de-civiparoisse"><a class="toclink" href="#objectifs-des-tests-automatises-dans-le-cadre-de-civiparoisse">Objectifs des tests automatisés dans le cadre de Civiparoisse</a></h2>
<p>L'intégration continue consiste à déclencher, en réponse à certains évènements, une série d'actions visant à vérifier si le code est de qualité. On peut trouver lors de ces actions des tests de tout type. Ils sont effectués pour détecter au plus tôt des éventuelles imperfections dans du code livré : il s'agit donc de garde-fous très utiles.<br />
L'intégration continue devient même essentielle si l'on souhaite faire du déploiement continu, c'est à dire mettre automatiquement du code dès qu'il est disponible - l'idée étant que des petits changements fréquemment mis en production vont produire, lorsque mis en production, des problèmes plus réduits et éventuellement plus faciles à résoudre qu'un changement radical et massif dans le code.</p>
<p>Au niveau de Civiparoisse, ces tests vont servir non seulement à éviter d'éventuelles régressions dues aux développements, mais on va également utiliser le lancement des tests pour vérifier qu'un certain niveau de fonctionnalité minimum est atteint par un build particulier avant d'être éventuellement mis en production.<br />
Cela est d'ailleurs particulièrement critique dans le cadre de Civiparoisse, lorsqu'il s'agit de déployer des builds avec des corrections de vulnérabilités logicielles, où il faut être assez réactif.</p>
<p>Comme Civiparoisse est hébergé sur Github pour les développements, et que le projet ne dispose pas d'une infrastructure informatique internalisée à l'UEPAL, il semble judicieux d'utiliser Github, au travers des workflows Github, pour implémenter les tests automatisés - un certain niveau de consommations de ressources étant d'ailleurs intégré dans certaines offres Github.</p>
<p>Une autre contrainte de l'intégration continue est qu'elle puisse être utilisable par un développeur pour vérifier si son travail n'a pas posé de problème. Sans oublier que les tests sont des composants logiciels que les développeurs doivent également maintenir.</p>
<h2 id="reflexions-resultant-des-objectifs"><a class="toclink" href="#reflexions-resultant-des-objectifs">Réflexions résultant des objectifs</a></h2>
<p>Etant donné qu'il va s'agir de tester l'intégration des éléments, l'élément que l'on va chercher à tester va être un build de l'image Civiparoisse, ce qui veut dire qu'il faut utiliser une infrastructure qui utilise la containeraisation, et plutôt sous Linux, pour rester dans le même domaine de compétences que l'image Civiparoisse.</p>
<p>Ceci est effectivement prévu au niveau de Github : Github prévoit d'exécuter chaque job d'un workflow dans un runner, qui peut être soit fourni par un tiers (typiquement un self-hosted runner, qu'il faut alors maintenir soi-même, ce qui serait difficile dans le cadre de Civiparoisse), ou alors fourni par Github. Dans le cadre du runner fourni par Github, il est possible d'avoir plusieurs choix de distribution de base, dont en particulier Ubuntu 22.04. Cependant, Github propose une machine virtuelle déjà préparée dans une certaine mesure pour le développement, selon <a href="https://github.com/actions/runner-images/blob/main/images/linux/Ubuntu2204-Readme.md">https://github.com/actions/runner-images/blob/main/images/linux/Ubuntu2204-Readme.md</a>, dont en particulier :</p>
<ul>
<li>docker, docker-compose</li>
<li>minikube, helm, kubectl</li>
<li>chrome, chromium et chromedriver</li>
<li>xvfb</li>
<li>firefox et geckodriver</li>
<li>composer, php 8, mysql, apache2</li>
</ul>
<p>Etant donné qu'il s'agit de disposer rapidement d'un environnement simplement atteignable par un développeur, il semble plus simple d'utiliser une infrastructure limitée au minimum en utilisant docker-compose. Bien entendu, cela signifie aussi que le fonctionnement testé ne sera pas exactement celui qui sera utilisé en production. On utilisera directement le serveur web Apache embarqué dans Civiparoisse sans passer par un proxy Traefik. Il serait en fait possible de rajouter Traefik dans le docker-compose, mais étant donné qu'il ne s'agirait quand même pas d'une installation semblable à celle en production (les moyens de configurations mis en oeuvre sont différents, par exemple), cela semble être peu opportun de s'embêter à installer le reverse proxy.</p>
<p>Il a été préféré de ne pas utiliser le mysql embarqué dans la VM, car il semble plus simple aussi du point de vue de mise en oeuvre pour un développeur de laisser faire le travail par un container. L'image mysql est rapidement téléchargée et démarrée, et on profite au passage des mécanismes d'initialisation prévus dans l'image.</p>
<p>En revanche, installer dans un container un navigateur et un driver peut devenir compliqué (d'expérience), avec des images qui deviennent lourdes, et là on dispose des éléments préinstallés dans l'hôte. De la même manière, un développeur qui travaille sur sa machine pourra modifier la configuration de codeception pour faire afficher le navigateur, ou même utiliser le navigateur de son choix. On utilisera donc le navigateur et le driver préinstallés. En plus, comme php et Composer sont installés, et qu'on voit dans les sources du runner github qu'il y a les extensions php nécessaires qui sont installées d'office (<a href="https://github.com/actions/runner-images/blob/main/images/linux/scripts/installers/php.sh">https://github.com/actions/runner-images/blob/main/images/linux/scripts/installers/php.sh</a>), on pourra déployer le code de test (et codeception) de deux manières différentes :</p>
<ul>
<li>soit par composer</li>
<li>soit par les actions github</li>
</ul>
<p>Le fait de passer par Composer pour la récupération et l'installation du code de test a un autre avantage assez important : il permet de découpler le code de test du tunnel d'intégration, et permet de lier via les tags l'évolution du code de build de l'image civiparoisse et l'évolution des tests.<br />
Par ailleurs, cette liaison règle également un problème d'accès aux données de différents dépôts au niveau du runner Github, puisqu'on peut publier le code de test comme on le fait pour les autres packages composer pour builder Civiparoisse. A vrai dire, pendant la phase de conception du tunnel, avant publication du package des tests, un dépôt taggé contenu dans un fichier tar.gz a été embarqué dans une branche, le dépôt est décompressé dans le tunnel, puis ce dépôt local, qui est déclaré dans le composer.json, est utilisé pour installer le code de test dans l'environnement.</p>
<p>Le fichier de test de workflow github résume ce test:</p>
<details class="info">
<summary>Fichier de test de workflow (cliquer pour déplier)</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Intégration Continue</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="nt">on</span><span class="p">:</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="nt">workflow_dispatch</span><span class="p">:</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span><span class="nt">INTERNALTAG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uepal_test/civiparoisseci:citest</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">  </span><span class="nt">WEBNAME </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">civiparoisseci.test</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">  </span><span class="nt">TESTRELPATH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/WORK/vendor/uepal/fr.uepalparoisse.ci</span><span class="w"> </span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="nt">defaults</span><span class="p">:</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">  </span><span class="nt">run</span><span class="p">:</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="nt">jobs</span><span class="p">:</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">  </span><span class="nt">citunnel</span><span class="p">:</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">   </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-22.04</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">   </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Checkout repository</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="w">     </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build Image for local use</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE} &amp;&amp; docker build -t ${INTERNALTAG} .</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pull mysql</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="w">       </span><span class="no">docker pull mysql</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prepare uncompress embedded git repo for tests</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE}/tests &amp;&amp; tar -xvzf REF.tar.gz</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prepare codeception</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE}/tests/WORK &amp;&amp; composer upgrade</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run db service</span>
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE}/${TESTRELPATH} &amp;&amp; docker-compose up -d db &amp;&amp; bash isupdb.sh</span>
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">install civiparoisse</span>
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE}/${TESTRELPATH} &amp;&amp; docker-compose up php_initialize</span>
<a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">update civiparoisse</span>
<a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE}/${TESTRELPATH} &amp;&amp; docker-compose up php_update</span>
<a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inject test data</span>
<a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE}/${TESTRELPATH} &amp;&amp; docker-compose up php_configure</span>
<a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch webserver</span>
<a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE}/${TESTRELPATH} &amp;&amp; docker-compose up -d php_webserver</span>
<a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch chromedriver</span>
<a id="__codelineno-4-48" name="__codelineno-4-48" href="#__codelineno-4-48"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-49" name="__codelineno-4-49" href="#__codelineno-4-49"></a><span class="w">       </span><span class="no">chromedriver&amp;</span>
<a id="__codelineno-4-50" name="__codelineno-4-50" href="#__codelineno-4-50"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inject name resolution into hosts</span>
<a id="__codelineno-4-51" name="__codelineno-4-51" href="#__codelineno-4-51"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w">       </span>
<a id="__codelineno-4-52" name="__codelineno-4-52" href="#__codelineno-4-52"></a><span class="w">       </span><span class="no">echo &quot;127.0.0.1 ${WEBNAME}&quot; | sudo tee -a /etc/hosts</span>
<a id="__codelineno-4-53" name="__codelineno-4-53" href="#__codelineno-4-53"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">run tests (and write down a failure)</span>
<a id="__codelineno-4-54" name="__codelineno-4-54" href="#__codelineno-4-54"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-55" name="__codelineno-4-55" href="#__codelineno-4-55"></a><span class="w">        </span><span class="no">(cd ${GITHUB_WORKSPACE}/${TESTRELPATH} &amp;&amp; ${GITHUB_WORKSPACE}/tests/WORK/vendor/bin/codecept run -g ci -vvv --steps) || (echo &quot;TEST FAILURE OCCURED&quot; &gt;${RUNNER_TEMP}/error.txt)</span>
<a id="__codelineno-4-56" name="__codelineno-4-56" href="#__codelineno-4-56"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v3</span>
<a id="__codelineno-4-57" name="__codelineno-4-57" href="#__codelineno-4-57"></a><span class="w">     </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-4-58" name="__codelineno-4-58" href="#__codelineno-4-58"></a><span class="w">       </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-result-ci-${{ github.run_number }}-${{ github.run_attempt }}</span>
<a id="__codelineno-4-59" name="__codelineno-4-59" href="#__codelineno-4-59"></a><span class="w">       </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.workspace }}/${{ env.TESTRELPATH }}/tests</span>
<a id="__codelineno-4-60" name="__codelineno-4-60" href="#__codelineno-4-60"></a><span class="w">       </span><span class="nt">retention-days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<a id="__codelineno-4-61" name="__codelineno-4-61" href="#__codelineno-4-61"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stop containers</span>
<a id="__codelineno-4-62" name="__codelineno-4-62" href="#__codelineno-4-62"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-63" name="__codelineno-4-63" href="#__codelineno-4-63"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE}/${TESTRELPATH} &amp;&amp; docker-compose down -v</span>
<a id="__codelineno-4-64" name="__codelineno-4-64" href="#__codelineno-4-64"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kill chromedriver</span>
<a id="__codelineno-4-65" name="__codelineno-4-65" href="#__codelineno-4-65"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-66" name="__codelineno-4-66" href="#__codelineno-4-66"></a><span class="w">       </span><span class="no">pkill chromedriver</span>
<a id="__codelineno-4-67" name="__codelineno-4-67" href="#__codelineno-4-67"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;last</span><span class="nv"> </span><span class="s">task</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">exit</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">non</span><span class="nv"> </span><span class="s">zero</span><span class="nv"> </span><span class="s">code</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">error&quot;</span>
<a id="__codelineno-4-68" name="__codelineno-4-68" href="#__codelineno-4-68"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-4-69" name="__codelineno-4-69" href="#__codelineno-4-69"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE}/${TESTRELPATH} &amp;&amp; bash exitcode.sh</span>
</code></pre></div>
</details>
<p>L'utilisation d'une action github est un autre moyen, qui est au bout du compte tout aussi simple à mettre en oeuvre, voire même plus simple : github permet de récupérer d'accéder au contenu des actions d'un autre dépôt privé si ledit dépôt autorise les accès pour les actions (cela se configure dans les paramètres du dépôt, dans l'interface web de github). Github se chargera de lui-même de récupérer le code du dépôt, et l'action pourra être réutilisée dans différents workflows, et permettra de réduire la quantité globale de code des workflows.</p>
<p>L'action en question est une action de type composite, qui mime en un certain nombre de points les éléments disponibles dans un workflow. Dans une action, le code du repository de l'action est disponible lors de l'exécution de l'action dans le répertoire appelé par <code>${{ github.action_path }}</code>. Le fait que ce soit une action permet de l'intégrer dans un job en tant que step, ce qui veut dire que l'on pourra bénéficier des effets des étapes précédentes du job, puisqu'elles sont exécutées sur le même runner.</p>
<p>On en arrive à un ficher action.yml tel que suit :</p>
<details class="info">
<summary>Action.yml (cliquer pour déplier)</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Tests</span><span class="nv"> </span><span class="s">codeception&#39;</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Exécution</span><span class="nv"> </span><span class="s">des</span><span class="nv"> </span><span class="s">tests</span><span class="nv"> </span><span class="s">automatisés&#39;</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nt">inputs</span><span class="p">:</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="nt">sutimage</span><span class="p">:</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;System</span><span class="nv"> </span><span class="s">Under</span><span class="nv"> </span><span class="s">Test</span><span class="nv"> </span><span class="s">Image</span><span class="nv"> </span><span class="s">(must</span><span class="nv"> </span><span class="s">already</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">available)</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">works</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">Linux</span><span class="nv"> </span><span class="s">runner&#39;</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;uepal_test/civiparoisseci:citest&#39;</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="nt">runs</span><span class="p">:</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">  </span><span class="nt">using</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;composite&quot;</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">  </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pull mysql</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">        </span><span class="no">docker pull mysql</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prepare codeception</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">        </span><span class="no">cd ${{ github.action_path }} &amp;&amp; composer upgrade</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run db service</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="w">        </span><span class="no">cd ${{ github.action_path }} &amp;&amp; docker-compose up -d db &amp;&amp; bash isupdb.sh</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="w">        </span><span class="nt">SUTIMAGE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ inputs.sutimage }}</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="w">        </span><span class="nt">WEBNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">civiparoisseci.test</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">install civiparoisse</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="w">        </span><span class="no">cd ${{ github.action_path }}  &amp;&amp; docker-compose up php_initialize</span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="w">        </span><span class="nt">SUTIMAGE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ inputs.sutimage }}</span>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="w">        </span><span class="nt">WEBNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">civiparoisseci.test</span>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">update civiparoisse</span>
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="w">        </span><span class="no">cd ${{ github.action_path }}  &amp;&amp; docker-compose up php_update</span>
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a><span class="w">        </span><span class="nt">SUTIMAGE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ inputs.sutimage }}</span>
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a><span class="w">        </span><span class="nt">WEBNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">civiparoisseci.test</span>
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inject test data</span>
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a><span class="w">        </span><span class="no">cd ${{ github.action_path }}  &amp;&amp; docker-compose up php_configure</span>
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a><span class="w">        </span><span class="nt">SUTIMAGE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ inputs.sutimage }}</span>
<a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a><span class="w">        </span><span class="nt">WEBNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">civiparoisseci.test</span>
<a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch webserver</span>
<a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a><span class="w">        </span><span class="no">cd ${{ github.action_path }}  &amp;&amp; docker-compose up -d php_webserver</span>
<a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a><span class="w">        </span><span class="nt">SUTIMAGE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ inputs.sutimage }}</span>
<a id="__codelineno-5-60" name="__codelineno-5-60" href="#__codelineno-5-60"></a><span class="w">        </span><span class="nt">WEBNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">civiparoisseci.test</span>
<a id="__codelineno-5-61" name="__codelineno-5-61" href="#__codelineno-5-61"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch chromedriver</span>
<a id="__codelineno-5-62" name="__codelineno-5-62" href="#__codelineno-5-62"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-63" name="__codelineno-5-63" href="#__codelineno-5-63"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-64" name="__codelineno-5-64" href="#__codelineno-5-64"></a><span class="w">        </span><span class="no">chromedriver&amp;</span>
<a id="__codelineno-5-65" name="__codelineno-5-65" href="#__codelineno-5-65"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-66" name="__codelineno-5-66" href="#__codelineno-5-66"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inject name resolution into hosts</span>
<a id="__codelineno-5-67" name="__codelineno-5-67" href="#__codelineno-5-67"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-68" name="__codelineno-5-68" href="#__codelineno-5-68"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w">       </span>
<a id="__codelineno-5-69" name="__codelineno-5-69" href="#__codelineno-5-69"></a><span class="w">        </span><span class="no">echo &quot;127.0.0.1 ${WEBNAME}&quot; | sudo tee -a /etc/hosts</span>
<a id="__codelineno-5-70" name="__codelineno-5-70" href="#__codelineno-5-70"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-71" name="__codelineno-5-71" href="#__codelineno-5-71"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-72" name="__codelineno-5-72" href="#__codelineno-5-72"></a><span class="w">        </span><span class="nt">SUTIMAGE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ inputs.sutimage }}</span>
<a id="__codelineno-5-73" name="__codelineno-5-73" href="#__codelineno-5-73"></a><span class="w">        </span><span class="nt">WEBNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">civiparoisseci.test</span>
<a id="__codelineno-5-74" name="__codelineno-5-74" href="#__codelineno-5-74"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">run tests (and write down a failure)</span>
<a id="__codelineno-5-75" name="__codelineno-5-75" href="#__codelineno-5-75"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-76" name="__codelineno-5-76" href="#__codelineno-5-76"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-77" name="__codelineno-5-77" href="#__codelineno-5-77"></a><span class="w">         </span><span class="no">(cd ${{ github.action_path }} &amp;&amp; vendor/bin/codecept run -g ci -vvv --steps) || (echo &quot;TEST FAILURE OCCURED&quot; &gt;${RUNNER_TEMP}/error.txt)</span>
<a id="__codelineno-5-78" name="__codelineno-5-78" href="#__codelineno-5-78"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-79" name="__codelineno-5-79" href="#__codelineno-5-79"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-80" name="__codelineno-5-80" href="#__codelineno-5-80"></a><span class="w">        </span><span class="nt">SUTIMAGE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ inputs.sutimage }}</span>
<a id="__codelineno-5-81" name="__codelineno-5-81" href="#__codelineno-5-81"></a><span class="w">        </span><span class="nt">WEBNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">civiparoisseci.test</span>
<a id="__codelineno-5-82" name="__codelineno-5-82" href="#__codelineno-5-82"></a><span class="w">        </span><span class="nt">RUNNER_TEMP</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ runner.temp }}</span>
<a id="__codelineno-5-83" name="__codelineno-5-83" href="#__codelineno-5-83"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v3</span>
<a id="__codelineno-5-84" name="__codelineno-5-84" href="#__codelineno-5-84"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-85" name="__codelineno-5-85" href="#__codelineno-5-85"></a><span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-5-86" name="__codelineno-5-86" href="#__codelineno-5-86"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-result-ci-${{ github.run_number }}-${{ github.run_attempt }}</span>
<a id="__codelineno-5-87" name="__codelineno-5-87" href="#__codelineno-5-87"></a><span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.action_path }}/tests</span>
<a id="__codelineno-5-88" name="__codelineno-5-88" href="#__codelineno-5-88"></a><span class="w">        </span><span class="nt">retention-days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<a id="__codelineno-5-89" name="__codelineno-5-89" href="#__codelineno-5-89"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stop containers</span>
<a id="__codelineno-5-90" name="__codelineno-5-90" href="#__codelineno-5-90"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-91" name="__codelineno-5-91" href="#__codelineno-5-91"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-92" name="__codelineno-5-92" href="#__codelineno-5-92"></a><span class="w">        </span><span class="no">cd ${{ github.action_path }} &amp;&amp; docker-compose down -v</span>
<a id="__codelineno-5-93" name="__codelineno-5-93" href="#__codelineno-5-93"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-94" name="__codelineno-5-94" href="#__codelineno-5-94"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-95" name="__codelineno-5-95" href="#__codelineno-5-95"></a><span class="w">        </span><span class="nt">SUTIMAGE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ inputs.sutimage }}</span>
<a id="__codelineno-5-96" name="__codelineno-5-96" href="#__codelineno-5-96"></a><span class="w">        </span><span class="nt">WEBNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">civiparoisseci.test</span>
<a id="__codelineno-5-97" name="__codelineno-5-97" href="#__codelineno-5-97"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kill chromedriver</span>
<a id="__codelineno-5-98" name="__codelineno-5-98" href="#__codelineno-5-98"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-99" name="__codelineno-5-99" href="#__codelineno-5-99"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-100" name="__codelineno-5-100" href="#__codelineno-5-100"></a><span class="w">        </span><span class="no">pkill chromedriver</span>
<a id="__codelineno-5-101" name="__codelineno-5-101" href="#__codelineno-5-101"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-102" name="__codelineno-5-102" href="#__codelineno-5-102"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;last</span><span class="nv"> </span><span class="s">task</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">exit</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">non</span><span class="nv"> </span><span class="s">zero</span><span class="nv"> </span><span class="s">code</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">error&quot;</span>
<a id="__codelineno-5-103" name="__codelineno-5-103" href="#__codelineno-5-103"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner.os == &#39;Linux&#39;</span><span class="w">      </span>
<a id="__codelineno-5-104" name="__codelineno-5-104" href="#__codelineno-5-104"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-5-105" name="__codelineno-5-105" href="#__codelineno-5-105"></a><span class="w">        </span><span class="no">cd ${{ github.action_path }} &amp;&amp; bash exitcode.sh</span>
<a id="__codelineno-5-106" name="__codelineno-5-106" href="#__codelineno-5-106"></a><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-5-107" name="__codelineno-5-107" href="#__codelineno-5-107"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-108" name="__codelineno-5-108" href="#__codelineno-5-108"></a><span class="w">        </span><span class="nt">SUTIMAGE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ inputs.sutimage }}</span>
<a id="__codelineno-5-109" name="__codelineno-5-109" href="#__codelineno-5-109"></a><span class="w">        </span><span class="nt">WEBNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">civiparoisseci.test</span>
<a id="__codelineno-5-110" name="__codelineno-5-110" href="#__codelineno-5-110"></a><span class="w">        </span><span class="nt">RUNNER_TEMP</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ runner.temp }}</span>
</code></pre></div>
</details>
<p>Un exemple de workflow d'utilisation est en-dessous. Il y a plusieurs manières de spécifier le commit de référence qui contient l'action : on peut utiliser les tags, ou une référence directe de commit (sachant que le tag peut pointer dans le temps vers un autre commit, ce qui ne peut pas se produire si on indique directement le commit que l'on souhaite).</p>
<details class="info">
<summary>Exemple d'intégration sous forme d'action (cliquer pour déplier)</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Intégration Continue Avec Action</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nt">on</span><span class="p">:</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">  </span><span class="nt">workflow_dispatch</span><span class="p">:</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">  </span><span class="nt">INTERNALTAG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uepal_test/civiparoisseci:citest</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="nt">defaults</span><span class="p">:</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">  </span><span class="nt">run</span><span class="p">:</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">    </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="nt">jobs</span><span class="p">:</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">  </span><span class="nt">citunnelaction</span><span class="p">:</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">   </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-22.04</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w">   </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Checkout repository</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">     </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build Image for local use</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">     </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">       </span><span class="no">cd ${GITHUB_WORKSPACE} &amp;&amp; docker build -t ${INTERNALTAG} .</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">execute tests</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">     </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UEPAL-CiviParoisse/integration_continue@11c25005a4d144eab0d9cfae094d0f859c2c92e5</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="w">     </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">       </span><span class="nt">sutimage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ env.INTERNALTAG }}</span>
</code></pre></div>
</details>
<p>Une autre problématique se pose également : la question de l'utilisation du mode avec affichage ou sans affichage (headless). L'affichage se ferait dans Xvfb, et la question se pose effectivement dans certains cas, car certains navigateurs n'auraient, au moins historiquement, pas utilisé le même code de rendu en headless qu'en mode normal. Toutefois, cela ajouterait un peu de complexité sans en voir l'intérêt immédiatement. Cependant, il faut se souvenir de cette possibilité, pour qu'on puisse passer en affichage Xvfb en cas de besoin.</p>
<h2 id="resume-de-la-solution-retenue"><a class="toclink" href="#resume-de-la-solution-retenue">Résumé de la solution retenue</a></h2>
<p>Pour résumer la solution obtenue :</p>
<ul>
<li>Tester les images fraichement buildées de Civiparoisse.</li>
<li>Utiliser l'infrastructure docker installée sur le runner maintenu par Github pour déployer localement une instance civiparoisse.</li>
<li>Utiliser une action github pour faire la liaison avec le code de test.</li>
<li>Utiliser un php, composer, browserdriver et un browser installés sur le runner pour interagir avec codeception et l'installation locale civiparoisse.</li>
</ul>
<p>Le dépôt dédié aux tests va contenir les fichiers nécessaires pour l'infrastructure de test :</p>
<ul>
<li>le docker-compose.yaml et les fichiers supports attenants montés via des volumes (ex : clefs, certificats, et fichiers de secrets "par défaut", qui vont être utilisés pour le test en local).</li>
<li>les tests proprement dits.</li>
<li>la déclaration de dépendance sur codeception.</li>
<li>l'extension pour la documentation.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Retour en haut de la page
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Pied de page" >
        
          
          <a href="docker_build_push.html" class="md-footer__link md-footer__link--prev" aria-label="Précédent: Docker build et push">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Précédent
              </span>
              <div class="md-ellipsis">
                Docker build et push
              </div>
            </div>
          </a>
        
        
          
          <a href="tests_phpunit.html" class="md-footer__link md-footer__link--next" aria-label="Suivant: Tests automatisés : Phpunit">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Suivant
              </span>
              <div class="md-ellipsis">
                Tests automatisés : Phpunit
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "navigation.sections", "navigation.indexes", "navigation.tabs", "navigation.top", "navigation.footer", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>